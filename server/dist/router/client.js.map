{"version":3,"sources":["../../src/router/client.js"],"names":["router","Router","use","req","res","next","path","findOne","result","update","$inc","num","multi","create","err","docs","console","log","post","get"],"mappings":";;;;;;;;;;;;;;AACA;;;;AACA;;;;AACA;;AAKA;;AAQA;;AAIA;;AAKA;;AAKA;;AAIA;;AAOA;;AAIA;;AAOA;;;;AAOA,IAAIA,SAAS,kBAAQC,MAAR,EAAb;;AAEAD,OAAOE,GAAP;AAAA,sFAAW,iBAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AACLC,gBADK,GACEH,IAAIG,IADN;AAAA;AAAA,mBAEU,cAAIC,OAAJ,CAAY,EAACD,UAAD,EAAZ,CAFV;;AAAA;AAELE,kBAFK;;AAAA,iBAGLA,MAHK;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAGS,cAAIC,MAAJ,CAAW,EAACH,UAAD,EAAX,EAAmB,EAACI,MAAM,EAACC,KAAK,EAAN,EAAP,EAAnB,EAAsC,EAACC,OAAO,KAAR,EAAtC,EAAsD,YAAM,CAAE,CAA9D,CAHT;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAKD,cAAIC,MAAJ,CAAW,EAACP,UAAD,EAAX,EAAmB,UAACQ,GAAD,EAAMC,IAAN,EAAe;AACtC,kBAAID,GAAJ,EAASE,QAAQC,GAAR,CAAY,iBAAZ,EAA+BH,GAA/B;AACV,aAFK,CALC;;AAAA;AAST,kDAAmBX,GAAnB,EAAwBC,GAAxB,EAA6BC,IAA7B;;AATS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAX;;AAAA;AAAA;AAAA;AAAA;;AAYAL,OAAOkB,IAAP,CAAY,QAAZ;AACAlB,OAAOmB,GAAP,CAAW,OAAX;AACAnB,OAAOkB,IAAP,CAAY,WAAZ;AACAlB,OAAOkB,IAAP,CAAY,WAAZ;AACAlB,OAAOkB,IAAP,CAAY,SAAZ;AACAlB,OAAOkB,IAAP,CAAY,aAAZ;AACAlB,OAAOkB,IAAP,CAAY,UAAZ;AACAlB,OAAOkB,IAAP,CAAY,UAAZ;AACAlB,OAAOkB,IAAP,CAAY,eAAZ;AACAlB,OAAOkB,IAAP,CAAY,OAAZ;AACAlB,OAAOkB,IAAP,CAAY,UAAZ;AACAlB,OAAOkB,IAAP,CAAY,cAAZ;AACAlB,OAAOkB,IAAP,CAAY,cAAZ;AACAlB,OAAOkB,IAAP,CAAY,WAAZ;AACAlB,OAAOkB,IAAP,CAAY,kBAAZ;AACAlB,OAAOkB,IAAP,CAAY,UAAZ;AACAlB,OAAOkB,IAAP,CAAY,UAAZ;AACAlB,OAAOkB,IAAP,CAAY,WAAZ;AACAlB,OAAOkB,IAAP,CAAY,UAAZ;AACAlB,OAAOkB,IAAP,CAAY,OAAZ;AACAlB,OAAOkB,IAAP,CAAY,MAAZ;AACAlB,OAAOkB,IAAP,CAAY,YAAZ;;kBAGelB,M","file":"client.js","sourcesContent":["\r\nimport express from 'express';\r\nimport Api from '../model/api.js';\r\nimport {\r\n  loginFunc,\r\n  getAllUserFunc\r\n} from '../controller/user.js';\r\n\r\nimport {\r\n  postFunc,\r\n  myPostedFunc,\r\n  postingFunc,\r\n  starFunc,\r\n  pinglunFunc\r\n} from '../controller/post.js';\r\n\r\nimport {\r\n  galleryFunc\r\n} from '../controller/gallery.js';\r\n\r\nimport {\r\n  myFriendFunc,\r\n  addFriendFunc\r\n} from '../controller/friend.js';\r\n\r\nimport {\r\n  myStarFunc,\r\n  myCommentsFunc\r\n} from '../controller/common.js';\r\n\r\nimport {\r\n  rankingFunc\r\n} from '../controller/ranking.js';\r\n\r\nimport {\r\n  toFollowFunc,\r\n  myFollowingFunc,\r\n  deleteFollowingFunc,\r\n  followsFunc\r\n} from '../controller/follow.js';\r\n\r\nimport {\r\n  apiFunc\r\n} from '../controller/api.js';\r\n\r\nimport {\r\n  userMainInfoFunc,\r\n  mineFunc,\r\n  postInfoFunc,\r\n  authenticationFunc\r\n} from '../controller/client_other.js';\r\n\r\nimport {\r\n  webMailSendFunc,\r\n  messageBoxListFunc,\r\n  ignoreMessageFunc,\r\n  sendWebMailFunc\r\n} from '../controller/message.js';\r\n\r\nvar router = express.Router();\r\n\r\nrouter.use(async (req, res, next) => {\r\n  let path = req.path;\r\n  let result = await Api.findOne({path});\r\n  if (result) await Api.update({path}, {$inc: {num: 12}}, {multi: false}, () => {});\r\n  else {\r\n    await Api.create({path}, (err, docs) => {\r\n      if (err) console.log('create user 出错了', err);\r\n    });\r\n  }\r\n  authenticationFunc(req, res, next);\r\n});\r\n\r\nrouter.post('/login', loginFunc);\r\nrouter.get('/post', postFunc);\r\nrouter.post('/myFriend', myFriendFunc);\r\nrouter.post('/myPosted', myPostedFunc);\r\nrouter.post('/myStar', myStarFunc);\r\nrouter.post('/myComments', myCommentsFunc);\r\nrouter.post('/ranking', rankingFunc);\r\nrouter.post('/allUser', getAllUserFunc);\r\nrouter.post('/userMainInfo', userMainInfoFunc);\r\nrouter.post('/mine', mineFunc);\r\nrouter.post('/follows', followsFunc);\r\nrouter.post('/myFollowing', myFollowingFunc);\r\nrouter.post('/sendWebMail', sendWebMailFunc);\r\nrouter.post('/toFollow', toFollowFunc);\r\nrouter.post('/deleteFollowing', deleteFollowingFunc);\r\nrouter.post('/posting', postingFunc);\r\nrouter.post('/gallery', galleryFunc);\r\nrouter.post('/postInfo', postInfoFunc);\r\nrouter.post('/pinglun', pinglunFunc);\r\nrouter.post('/star', starFunc);\r\nrouter.post('/api', apiFunc);\r\nrouter.post('/addFriend', addFriendFunc);\r\n\r\n\r\nexport default router;\r\n"]}